import{b as N}from"./chunk-IOWFGKQA.js";import{b as T,d as B,i as V,v as F}from"./chunk-GIRLNUDQ.js";import{b as j}from"./chunk-7L4EOTHW.js";import{n as $}from"./chunk-MQVH6ZV5.js";import{Ka as a,Lc as k,Mb as _,Mc as E,Nb as l,Ob as c,Pb as w,Sb as S,X as C,Ya as M,aa as m,bc as s,cc as d,dc as O,gc as I,lb as y,mb as D,nb as u,ob as n,pb as o,q as h,r as v,ra as x,y as b,zb as P}from"./chunk-V4EMFQCR.js";import"./chunk-EQDQRRRY.js";var f=class r{store=m($);filterText=x("");ticker$=b(0,500);allData$=v([this.store.state$,this.ticker$]).pipe(h(([e])=>{let t=Date.now();return Array.from(e.values()).map(i=>{let p=(t-i.timestamp)/1e3;return{path:i.path,value:i.value,formattedValue:this.formatValue(i.value),ageSeconds:p,ageClass:p<=2?"fresh":p<=5?"stale":"dead",source:i.source,timestamp:i.timestamp}})}));allData=N(this.allData$,{initialValue:[]});vm=I(()=>{let e=this.allData(),t=this.filterText().toLowerCase(),p=[...t?e.filter(g=>g.path.toLowerCase().includes(t)):e].sort((g,L)=>g.path.localeCompare(L.path));return{rows:p,totalCount:e.length,filteredCount:p.length}});setFilter(e){this.filterText.set(e)}formatValue(e){return typeof e=="number"?e.toFixed(4):typeof e=="object"&&e!==null?JSON.stringify(e):String(e)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=C({token:r,factory:r.\u0275fac,providedIn:"root"})};var A=(r,e)=>e.path;function J(r,e){if(r&1&&(n(0,"tr")(1,"td",6),l(2),o(),n(3,"td",7),l(4),o(),n(5,"td",8),l(6),s(7,"number"),o(),n(8,"td",9),l(9),o()()),r&2){let t=e.$implicit;a(),u("title",t.path),a(),c(t.path),a(2),c(t.formattedValue),a(),_(t.ageClass),a(),w(" ",O(7,7,t.ageSeconds,"1.1-1"),"s "),a(3),c(t.source)}}var z=class r{facade=m(f);static \u0275fac=function(t){return new(t||r)};static \u0275cmp=M({type:r,selectors:[["app-diagnostics-page"]],decls:28,vars:27,consts:[[1,"diag-page"],[1,"toolbar"],["type","text",1,"search-input",3,"ngModelChange","placeholder","ngModel"],[1,"stats"],[1,"table-container"],[1,"diag-table"],[1,"path-col",3,"title"],[1,"value-col"],[1,"age-col"],[1,"source-col"]],template:function(t,i){t&1&&(n(0,"div",0)(1,"div",1)(2,"input",2),s(3,"translate"),P("ngModelChange",function(g){return i.facade.setFilter(g)}),o(),n(4,"div",3),l(5),s(6,"translate"),s(7,"translate"),s(8,"translate"),o()(),n(9,"div",4)(10,"table",5)(11,"thead")(12,"tr")(13,"th"),l(14),s(15,"translate"),o(),n(16,"th"),l(17),s(18,"translate"),o(),n(19,"th"),l(20),s(21,"translate"),o(),n(22,"th"),l(23),s(24,"translate"),o()()(),n(25,"tbody"),y(26,J,10,10,"tr",null,A),o()()()()),t&2&&(a(2),u("placeholder",d(3,11,"diagnostics.page.search_placeholder"))("ngModel",i.facade.filterText()),a(3),S(" ",d(6,13,"diagnostics.page.stats.showing")," ",i.facade.vm().filteredCount," ",d(7,15,"diagnostics.page.stats.of")," ",i.facade.vm().totalCount," ",d(8,17,"diagnostics.page.stats.points")," "),a(9),c(d(15,19,"diagnostics.page.table.path")),a(3),c(d(18,21,"diagnostics.page.table.value")),a(3),c(d(21,23,"diagnostics.page.table.age")),a(3),c(d(24,25,"diagnostics.page.table.source")),a(3),D(i.facade.vm().rows))},dependencies:[E,F,T,B,V,k,j],styles:["[_nghost-%COMP%]{display:block;height:100%;min-height:0}.diag-page[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;padding:1rem;gap:1rem;min-height:0}.toolbar[_ngcontent-%COMP%]{flex-shrink:0;display:flex;align-items:center;gap:1rem}.search-input[_ngcontent-%COMP%]{padding:.5rem .75rem;border-radius:6px;border:1px solid var(--card-border);background:var(--card-bg);color:var(--fg);width:300px;font-size:.875rem}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--gb-needle-secondary)}.stats[_ngcontent-%COMP%]{color:var(--muted);font-size:.875rem}.table-container[_ngcontent-%COMP%]{flex:1;overflow:auto;background:var(--card-bg);border-radius:var(--radius);border:1px solid var(--card-border);min-height:0}.diag-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;text-align:left;font-size:.875rem}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:.75rem 1rem;border-bottom:1px solid var(--card-border)}th[_ngcontent-%COMP%]{background:var(--bg);position:sticky;top:0;font-weight:600;color:var(--fg)}.path-col[_ngcontent-%COMP%]{font-family:var(--font-mono);font-size:.8125rem}.value-col[_ngcontent-%COMP%], .age-col[_ngcontent-%COMP%]{font-family:var(--font-mono)}.age-col.fresh[_ngcontent-%COMP%]{color:var(--success)}.age-col.stale[_ngcontent-%COMP%]{color:var(--warn)}.age-col.dead[_ngcontent-%COMP%]{color:var(--danger)}.source-col[_ngcontent-%COMP%]{color:var(--muted)}"],changeDetection:0})};export{z as DiagnosticsPage};
