import{e as T,f as U}from"./chunk-CXUFKEQG.js";import"./chunk-ZNRZW4BI.js";import{b as E,d as z,i as W,v as B}from"./chunk-GIRLNUDQ.js";import{Bb as C,Cc as S,Hc as w,Ka as a,Kb as _,Mc as $,Nb as o,Ob as M,Pb as y,Tb as P,Ub as k,Vb as O,Ya as v,aa as m,bb as f,bc as r,cc as s,g as p,hb as x,nb as u,ob as n,pb as i,qb as h,zb as b}from"./chunk-V4EMFQCR.js";import"./chunk-EQDQRRRY.js";function I(c,d){if(c&1&&(n(0,"div",15),r(1,"async"),h(2,"span",16),n(3,"span",17),o(4),r(5,"async"),i()()),c&2){let e=C();x("data-status",s(1,2,e.testStatus$)),a(4),M(s(5,4,e.statusMessage$))}}var D=class c{router=m(T);serverUrl="ws://localhost:3000";testStatus$=new p("idle");statusMessage$=new p("");testConnection(){if(this.testStatus$.value==="testing")return;this.testStatus$.next("testing"),this.statusMessage$.next("Connecting\u2026");let d=this.buildWsUrl(this.serverUrl),e=null,t=setTimeout(()=>{e?.close(),this.testStatus$.next("error"),this.statusMessage$.next("Connection timed out after 5 seconds.")},5e3);try{e=new WebSocket(d),e.onopen=()=>{clearTimeout(t),this.testStatus$.next("success"),this.statusMessage$.next("Connected to Signal K server."),e?.close()},e.onerror=()=>{clearTimeout(t),this.testStatus$.next("error"),this.statusMessage$.next("Unable to connect. Check the URL and try again.")}}catch(l){clearTimeout(t),this.testStatus$.next("error"),this.statusMessage$.next("Invalid URL format.")}}skipWithDemo(){this.router.navigate(["/onboarding/vessel"],{queryParams:{demo:!0}})}buildWsUrl(d){let e=d.replace(/\/+$/,"");return e.includes("/signalk/")?e:`${e}/signalk/v1/stream?subscribe=none`}static \u0275fac=function(e){return new(e||c)};static \u0275cmp=v({type:c,selectors:[["app-onboarding-connection"]],decls:30,vars:14,consts:[[1,"onboarding-page"],[1,"onboarding-card"],["routerLink","/onboarding/welcome",1,"back-link"],[1,"onboarding-title"],[1,"onboarding-subtitle"],[1,"onboarding-description"],[1,"field"],["for","sk-url",1,"field-label"],[1,"field-row"],["id","sk-url","type","url","placeholder","ws://localhost:3000","autocomplete","off","spellcheck","false",1,"field-input",3,"ngModelChange","ngModel"],["type","button",1,"field-action",3,"click","disabled"],["class","connection-status",4,"ngIf"],[1,"actions"],["routerLink","/onboarding/vessel",1,"onboarding-btn","onboarding-btn--primary"],["type","button",1,"onboarding-btn","onboarding-btn--ghost",3,"click"],[1,"connection-status"],[1,"status-dot"],[1,"status-text"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"div",1)(2,"a",2),o(3,"\u2190 Back"),i(),n(4,"h1",3),o(5,"Connect to Signal K"),i(),n(6,"p",4),o(7,"Step 1 of 2"),i(),n(8,"p",5),o(9," Enter the WebSocket URL of your Signal\xA0K server. If you're running OpenPlotter, the default is usually "),n(10,"code"),o(11,"ws://openplotter.local:3000"),i(),o(12,". "),i(),n(13,"div",6)(14,"label",7),o(15,"Server URL"),i(),n(16,"div",8)(17,"input",9),O("ngModelChange",function(g){return k(t.serverUrl,g)||(t.serverUrl=g),g}),i(),n(18,"button",10),r(19,"async"),b("click",function(){return t.testConnection()}),o(20),r(21,"async"),i()()(),f(22,I,6,6,"div",11),r(23,"async"),n(24,"div",12)(25,"a",13),r(26,"async"),o(27," Continue "),i(),n(28,"button",14),b("click",function(){return t.skipWithDemo()}),o(29," Use Demo Mode "),i()()()()),e&2&&(a(17),P("ngModel",t.serverUrl),a(),u("disabled",s(19,6,t.testStatus$)==="testing"),a(2),y(" ",s(21,8,t.testStatus$)==="testing"?"Testing\u2026":"Test"," "),a(2),u("ngIf",s(23,10,t.testStatus$)!=="idle"),a(3),_("disabled",s(26,12,t.testStatus$)!=="success"))},dependencies:[$,S,U,B,E,z,W,w],styles:["[_nghost-%COMP%]{display:block;height:100%}.onboarding-page[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100%;padding:var(--space-4);background:var(--gb-bg-canvas)}.onboarding-card[_ngcontent-%COMP%]{width:100%;max-width:480px;padding:var(--space-8);background:var(--gb-bg-panel);border:1px solid var(--border-default);border-radius:var(--radius-xl, 12px)}.back-link[_ngcontent-%COMP%]{display:inline-block;margin-bottom:var(--space-4);font-size:.8125rem;color:var(--gb-text-muted);text-decoration:none}.back-link[_ngcontent-%COMP%]:hover{color:var(--gb-text-value)}.onboarding-title[_ngcontent-%COMP%]{margin:0 0 var(--space-1) 0;font-size:1.25rem;font-weight:700;color:var(--gb-text-value)}.onboarding-subtitle[_ngcontent-%COMP%]{margin:0 0 var(--space-4) 0;font-size:.75rem;color:var(--gb-text-muted);text-transform:uppercase;letter-spacing:.08em}.onboarding-description[_ngcontent-%COMP%]{margin:0 0 var(--space-6) 0;font-size:.875rem;line-height:1.6;color:var(--gb-text-muted)}.onboarding-description[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{padding:2px 6px;font-size:.8125rem;background:var(--bg-elevated, var(--gb-bg-panel));border-radius:var(--radius-sm, 4px);color:var(--accent, #88c0d0)}.field[_ngcontent-%COMP%]{margin-bottom:var(--space-4)}.field-label[_ngcontent-%COMP%]{display:block;margin-bottom:var(--space-1);font-size:.8125rem;font-weight:600;color:var(--gb-text-muted)}.field-row[_ngcontent-%COMP%]{display:flex;gap:var(--space-2)}.field-input[_ngcontent-%COMP%]{flex:1;height:44px;padding:0 var(--space-3);font-size:.875rem;color:var(--gb-text-value);background:var(--gb-bg-canvas);border:1px solid var(--border-default);border-radius:var(--radius-md, 8px);outline:none;font-family:monospace}.field-input[_ngcontent-%COMP%]:focus{border-color:var(--accent, #88c0d0)}.field-action[_ngcontent-%COMP%]{height:44px;padding:0 var(--space-4);font-size:.8125rem;font-weight:600;color:var(--gb-text-value);background:var(--bg-elevated, var(--gb-bg-panel));border:1px solid var(--border-default);border-radius:var(--radius-md, 8px);cursor:pointer;white-space:nowrap}.field-action[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.connection-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-2);padding:var(--space-3);margin-bottom:var(--space-4);font-size:.8125rem;border-radius:var(--radius-md, 8px);border:1px solid var(--border-default)}.status-dot[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%;flex-shrink:0}[data-status=testing][_ngcontent-%COMP%]   .status-dot[_ngcontent-%COMP%]{background:var(--warn, #ebcb8b)}[data-status=success][_ngcontent-%COMP%]   .status-dot[_ngcontent-%COMP%]{background:var(--success, #a3be8c)}[data-status=error][_ngcontent-%COMP%]   .status-dot[_ngcontent-%COMP%]{background:var(--danger, #bf616a)}.status-text[_ngcontent-%COMP%]{color:var(--gb-text-muted)}.actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-2);margin-top:var(--space-6)}.onboarding-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;height:44px;padding:0 var(--space-6);font-size:.875rem;font-weight:600;text-decoration:none;border-radius:var(--radius-md, 8px);border:none;cursor:pointer;transition:opacity .15s ease}.onboarding-btn[_ngcontent-%COMP%]:hover{opacity:.9}.onboarding-btn--primary[_ngcontent-%COMP%]{color:var(--bg-base, #0b1116);background:var(--accent, #88c0d0);text-align:center}.onboarding-btn--primary.disabled[_ngcontent-%COMP%]{opacity:.4;pointer-events:none}.onboarding-btn--ghost[_ngcontent-%COMP%]{color:var(--gb-text-muted);background:transparent;border:1px solid var(--border-default)}"],changeDetection:0})};export{D as OnboardingConnectionPage};
