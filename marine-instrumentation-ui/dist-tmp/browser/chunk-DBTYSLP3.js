import{a as h}from"./chunk-LX3RFNK4.js";import{Bc as w,Ka as n,Kb as _,Mc as R,Nb as d,Ob as $,Pb as S,Sa as z,Ta as P,Ya as T,_a as D,aa as m,bb as C,ha as p,hb as r,ka as I,nb as b,ob as o,pb as s,qb as c,va as M,ya as x}from"./chunk-V4EMFQCR.js";function v(a){let i=E(a);return{logicalAngle:i,visualAngle:i}}function F(a,i){let t=E(i),e=(t-a.logicalAngle+540)%360-180;return{logicalAngle:t,visualAngle:a.visualAngle+e}}function E(a){return(a%360+360)%360}function Q(a,i,t){return`rotate(${a.visualAngle}, ${i}, ${t})`}var f=class a{gbDataQuality;interval;qualityService=m(h);renderer=m(z);el=m(x);ngOnInit(){this.interval=setInterval(()=>this.updateQualityClass(),2e3),this.updateQualityClass()}updateQualityClass(){let i=this.qualityService.getQuality(this.gbDataQuality);["good","warn","stale","missing"].forEach(e=>{this.renderer.removeClass(this.el.nativeElement,`gb-quality--${e}`)}),this.renderer.addClass(this.el.nativeElement,`gb-quality--${i}`)}ngOnDestroy(){this.interval&&clearInterval(this.interval)}static \u0275fac=function(t){return new(t||a)};static \u0275dir=D({type:a,selectors:[["","gbDataQuality",""]],inputs:{gbDataQuality:"gbDataQuality"}})};function N(a,i){if(a&1&&(p(),c(0,"line",28)),a&2){let t=i.$implicit;r("x1",t.x1)("y1",t.y1)("x2",t.x2)("y2",t.y2)}}function q(a,i){if(a&1&&(p(),c(0,"line",29)),a&2){let t=i.$implicit;r("x1",t.x1)("y1",t.y1)("x2",t.x2)("y2",t.y2)}}function B(a,i){if(a&1&&(p(),o(0,"text",30),d(1),s()),a&2){let t=i.$implicit;r("x",t.x)("y",t.y)("transform",t.rotate),n(),S(" ",t.value," ")}}var A=class a{constructor(i){this.doc=i}value=0;heading;size=240;timestamp=0;unit="\xB0 TRUE";cog;bearingTo;interactive=!1;_rotationState=v(0);_rotationInitialized=!1;_instanceId=`gb-compass-${Math.random().toString(36).slice(2,10)}`;qualityService=m(h);ngOnInit(){this._rotationInitialized||(this._rotationState=v(this._inputAngle()),this._rotationInitialized=!0)}ngOnChanges(i){if(i.value||i.heading){let t=this._inputAngle();this._rotationInitialized?this._rotationState=F(this._rotationState,t):(this._rotationState=v(t),this._rotationInitialized=!0)}}get cx(){return this.size/2}get cy(){return this.size/2}get outerRadius(){return this.size/2-2}get faceRadius(){return this.size/2-8}get cardinalOffset(){return Math.round(this.size*.09)}get displayFontSize(){return Math.round(this.size*.13)}get formattedValue(){return this.qualityService.getIndicator(this._rotationState.logicalAngle,this.timestamp,t=>String(Math.round(t)%360).padStart(3,"0")).displayValue??"---"}get quality(){return this.qualityService.getQuality(this.timestamp)}get isStale(){return this.quality==="stale"}get faceGradientId(){return`${this._instanceId}-face-gradient`}get needleGradientId(){return`${this._instanceId}-needle-gradient`}get neonGlowId(){return`${this._instanceId}-neon-glow`}get instrumentClipId(){return`${this._instanceId}-instrument-clip`}get needleFilter(){return(this.doc.documentElement.getAttribute("data-theme")??"night")==="night"&&!this.isStale?`url(#${this.neonGlowId})`:"none"}get needlePoints(){let i=this.cx,t=this.cy,e=t-this.faceRadius*.72,l=t+this.faceRadius*.15,g=this.size*.025;return`${i},${e} ${i-g},${l} ${i+g},${l}`}get needleCounterweightPoints(){let i=this.cx,t=this.cy,e=t+this.faceRadius*.35,l=t+this.faceRadius*.15,g=this.size*.018;return`${i},${e} ${i-g},${l} ${i+g},${l}`}get needleTransform(){return Q(this._rotationState,this.cx,this.cy)}get majorTicks(){return this._generateTicks(10,12,18)}get minorTicks(){return this._generateTicks(5,6,8,10)}get degreeLabels(){let i=[],t=this.faceRadius-Math.round(this.size*.16);for(let e=0;e<360;e+=30){if(e%90===0)continue;let l=(e-90)*Math.PI/180,g=this.cx+t*Math.cos(l),u=this.cy+t*Math.sin(l);i.push({x:g,y:u,value:String(e/10).padStart(2,"0"),rotate:`rotate(${e}, ${g}, ${u})`})}return i}trackByIndex(i){return i}_inputAngle(){return this.heading??this.value}_generateTicks(i,t,e,l){let g=[];for(let u=0;u<360;u+=i){if(l&&u%l===0)continue;let y=(u-90)*Math.PI/180,k=this.faceRadius-t,O=this.faceRadius-e;g.push({x1:this.cx+k*Math.cos(y),y1:this.cy+k*Math.sin(y),x2:this.cx+O*Math.cos(y),y2:this.cy+O*Math.sin(y)})}return g}static \u0275fac=function(t){return new(t||a)(P(I))};static \u0275cmp=T({type:a,selectors:[["app-compass"]],inputs:{value:"value",heading:"heading",size:"size",timestamp:"timestamp",unit:"unit",cog:"cog",bearingTo:"bearingTo",interactive:"interactive"},features:[M],decls:39,vars:52,consts:[["role","img",1,"gb-instrument-svg"],["cx","50%","cy","50%","r","50%"],["offset","0%","stop-color","var(--gb-bg-panel)"],["offset","100%","stop-color","var(--gb-bg-bezel)"],["x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","var(--gb-needle-primary)"],["offset","100%","stop-color","color-mix(in srgb, var(--gb-needle-primary) 70%, var(--gb-bg-canvas))"],["x","-20%","y","-20%","width","140%","height","140%"],["stdDeviation","2","result","blur"],["in","SourceGraphic","in2","blur","operator","over"],["fill","var(--gb-bg-bezel)",1,"gb-bezel"],["stroke","var(--gb-border-panel)","stroke-width","1",1,"gb-face"],[1,"gb-ticks-group"],["stroke","var(--gb-tick-major)","stroke-width","1.5","stroke-linecap","round",4,"ngFor","ngForOf","ngForTrackBy"],["stroke","var(--gb-tick-minor)","stroke-width","0.75",4,"ngFor","ngForOf","ngForTrackBy"],[1,"gb-cardinals-group"],[1,"gb-svg-cardinal","gb-cardinal-n"],[1,"gb-svg-cardinal"],["class","gb-svg-degree-label",4,"ngFor","ngForOf","ngForTrackBy"],[1,"gb-display-group","gb-value-updating",3,"gbDataQuality"],["x","-32","y","-22","width","64","height","44","rx","4","fill","color-mix(in srgb, var(--gb-bg-canvas) 70%, transparent)"],["x","0","y","-4",1,"gb-svg-value","gb-display-value--lg"],["x","0","y","14","font-size","9",1,"gb-svg-unit"],[1,"gb-needle-wrapper"],[1,"gb-needle-shape"],["fill","var(--gb-bg-bezel)","opacity","0.8"],["r","5","fill","var(--gb-needle-pin)","stroke","var(--gb-needle-pin-border)","stroke-width","1.5",1,"gb-center-pin"],["fill","var(--gb-text-value)","opacity","0.04",1,"gb-glass-overlay"],["stroke","var(--gb-tick-major)","stroke-width","1.5","stroke-linecap","round"],["stroke","var(--gb-tick-minor)","stroke-width","0.75"],[1,"gb-svg-degree-label"]],template:function(t,e){t&1&&(p(),o(0,"svg",0)(1,"defs")(2,"radialGradient",1),c(3,"stop",2)(4,"stop",3),s(),o(5,"linearGradient",4),c(6,"stop",5)(7,"stop",6),s(),o(8,"filter",7),c(9,"feGaussianBlur",8)(10,"feComposite",9),s(),o(11,"clipPath"),c(12,"circle"),s()(),c(13,"circle",10)(14,"circle",11),o(15,"g",12),C(16,N,1,4,"line",13)(17,q,1,4,"line",14),s(),o(18,"g",15)(19,"text",16),d(20,"N"),s(),o(21,"text",17),d(22,"S"),s(),o(23,"text",17),d(24,"E"),s(),o(25,"text",17),d(26,"W"),s(),C(27,B,2,4,"text",18),s(),o(28,"g",19),c(29,"rect",20),o(30,"text",21),d(31),s(),o(32,"text",22),d(33),s()(),o(34,"g",23),c(35,"polygon",24)(36,"polygon",25),s(),c(37,"circle",26)(38,"ellipse",27),s()),t&2&&(r("viewBox","0 0 "+e.size+" "+e.size)("width",e.size)("height",e.size)("aria-label","Compass: "+e.formattedValue+" "+e.unit),n(2),r("id",e.faceGradientId),n(3),r("id",e.needleGradientId),n(3),r("id",e.neonGlowId),n(3),r("id",e.instrumentClipId),n(),r("cx",e.cx)("cy",e.cy)("r",e.faceRadius),n(),r("cx",e.cx)("cy",e.cy)("r",e.outerRadius),n(),r("cx",e.cx)("cy",e.cy)("r",e.faceRadius)("fill","url(#"+e.faceGradientId+")"),n(2),b("ngForOf",e.majorTicks)("ngForTrackBy",e.trackByIndex),n(),b("ngForOf",e.minorTicks)("ngForTrackBy",e.trackByIndex),n(2),r("x",e.cx)("y",e.cardinalOffset),n(2),r("x",e.cx)("y",e.size-e.cardinalOffset),n(2),r("x",e.size-e.cardinalOffset)("y",e.cy+1),n(2),r("x",e.cardinalOffset)("y",e.cy+1),n(2),b("ngForOf",e.degreeLabels)("ngForTrackBy",e.trackByIndex),n(),_("gb-value-updating--stale",e.isStale),b("gbDataQuality",e.timestamp),r("transform","translate("+e.cx+","+e.cy+")"),n(2),r("font-size",e.displayFontSize),n(),S(" ",e.formattedValue," "),n(2),$(e.unit),n(),_("gb-needle-wrapper--stale",e.isStale),r("transform",e.needleTransform)("filter",e.needleFilter),n(),r("points",e.needlePoints)("fill","url(#"+e.needleGradientId+")"),n(),r("points",e.needleCounterweightPoints),n(),r("cx",e.cx)("cy",e.cy),n(),r("cx",e.cx)("cy",e.cy*.6)("rx",e.faceRadius*.7)("ry",e.faceRadius*.35))},dependencies:[R,w,f],styles:["[_nghost-%COMP%]{display:inline-block;line-height:0}.gb-instrument-svg[_ngcontent-%COMP%]{display:block;filter:drop-shadow(0 2px 6px color-mix(in srgb,var(--gb-bg-canvas) 70%,var(--gb-bg-bezel)))}.gb-bezel[_ngcontent-%COMP%], .gb-face[_ngcontent-%COMP%], .gb-glass-overlay[_ngcontent-%COMP%], .gb-center-pin[_ngcontent-%COMP%]{transition:fill var(--gb-anim-theme) ease,stroke var(--gb-anim-theme) ease,opacity var(--gb-anim-theme) ease}.gb-ticks-group[_ngcontent-%COMP%]   line[_ngcontent-%COMP%]{vector-effect:non-scaling-stroke}.gb-cardinal-n[_ngcontent-%COMP%]{fill:var(--gb-needle-primary)}.gb-svg-degree-label[_ngcontent-%COMP%]{font-family:var(--font-mono);font-size:6px;font-weight:500;fill:var(--gb-text-muted);text-anchor:middle;dominant-baseline:middle;font-variant-numeric:tabular-nums}.gb-display-group[_ngcontent-%COMP%]   rect[_ngcontent-%COMP%]{stroke:var(--gb-border-panel);stroke-width:.75}.gb-display-group.gb-quality--warn[_ngcontent-%COMP%]   rect[_ngcontent-%COMP%]{stroke:rgba(var(--gb-data-warn-rgb),.7)}.gb-display-group.gb-quality--stale[_ngcontent-%COMP%]   rect[_ngcontent-%COMP%], .gb-display-group.gb-quality--missing[_ngcontent-%COMP%]   rect[_ngcontent-%COMP%]{stroke:rgba(var(--gb-data-stale-rgb),.75)}.gb-needle-shape[_ngcontent-%COMP%]{stroke:color-mix(in srgb,var(--gb-needle-primary) 70%,var(--gb-bg-canvas));stroke-width:.5}[data-theme=day][_nghost-%COMP%]   .gb-glass-overlay[_ngcontent-%COMP%], [data-theme=day]   [_nghost-%COMP%]   .gb-glass-overlay[_ngcontent-%COMP%]{opacity:.015}[data-theme=night][_nghost-%COMP%]   .gb-glass-overlay[_ngcontent-%COMP%], [data-theme=night]   [_nghost-%COMP%]   .gb-glass-overlay[_ngcontent-%COMP%]{opacity:.04}"],changeDetection:0})};export{v as a,F as b,A as c};
