import{c as R}from"./chunk-UQKADMW7.js";import"./chunk-KRD4IU53.js";import{b as H}from"./chunk-IOWFGKQA.js";import"./chunk-GIRLNUDQ.js";import{b as F}from"./chunk-7L4EOTHW.js";import{a as B}from"./chunk-224KP37M.js";import{a as e,n as v}from"./chunk-MQVH6ZV5.js";import"./chunk-OR3LRC23.js";import{Bb as u,Cc as G,Jb as A,Ka as r,Kb as m,Mc as f,Nb as s,Ob as p,Pb as L,Qb as E,Ya as y,aa as c,bb as k,bc as N,cc as W,fa as S,ga as O,gc as V,hb as d,lb as M,mb as P,nb as g,ob as o,pb as l,qb as b,ra as T,xb as D,zb as h}from"./chunk-V4EMFQCR.js";import"./chunk-EQDQRRRY.js";function K(i,t){if(i&1&&(o(0,"div",7),b(1,"div",8),l()),i&2){let a=u();r(),A("width",a.barPercent,"%"),d("data-level",a.barLevel)}}var _=class i{config;compact=!1;store=c(v);sub;rawValue=null;timestamp=0;quality="missing";STALE_MS=5e3;get displayValue(){if(this.quality==="missing"||this.rawValue===null||this.quality==="stale")return"---";let t=this.config.decimals??1;return this.rawValue.toFixed(t)}get barPercent(){if(this.rawValue===null||this.config.minValue==null||this.config.maxValue==null)return 0;let t=this.config.maxValue-this.config.minValue;if(t<=0)return 0;let a=(this.rawValue-this.config.minValue)/t*100;return Math.max(0,Math.min(100,a))}get barLevel(){return this.rawValue===null?"ok":this.config.dangerLow!=null&&this.rawValue<=this.config.dangerLow||this.config.dangerHigh!=null&&this.rawValue>=this.config.dangerHigh?"danger":this.config.warnLow!=null&&this.rawValue<=this.config.warnLow||this.config.warnHigh!=null&&this.rawValue>=this.config.warnHigh?"warn":"ok"}ngOnInit(){this.config.path&&(this.sub=this.store.observe(this.config.path).subscribe({next:t=>{if(!t){this.quality="missing",this.rawValue=null;return}let a=t.value;if(typeof a!="number"||!Number.isFinite(a)){this.quality="missing",this.rawValue=null;return}this.rawValue=a,this.timestamp=typeof t.timestamp=="string"?Date.parse(t.timestamp):t.timestamp;let n=Date.now()-this.timestamp;this.quality=n>this.STALE_MS?"stale":"good"}}))}ngOnDestroy(){this.sub?.unsubscribe()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=y({type:i,selectors:[["omi-instrument-widget"]],inputs:{config:"config",compact:"compact"},decls:10,vars:11,consts:[[1,"instrument-tile"],[1,"instrument-tile__label"],[1,"instrument-tile__gauge"],["class","instrument-tile__bar-track",4,"ngIf"],[1,"instrument-tile__value-group"],[1,"instrument-tile__value"],[1,"instrument-tile__unit"],[1,"instrument-tile__bar-track"],[1,"instrument-tile__bar-fill"]],template:function(a,n){a&1&&(o(0,"div",0)(1,"span",1),s(2),l(),o(3,"div",2),k(4,K,2,3,"div",3),l(),o(5,"div",4)(6,"span",5),s(7),l(),o(8,"span",6),s(9),l()()()),a&2&&(m("instrument-tile--compact",n.compact)("instrument-tile--wide",n.config.displayType==="analog-linear")("instrument-tile--stale",n.quality==="stale"),d("data-quality",n.quality),r(2),p(n.config.label),r(2),g("ngIf",n.config.displayType==="analog-linear"&&n.config.minValue!=null&&n.config.maxValue!=null),r(3),p(n.displayValue),r(2),p(n.config.unit))},dependencies:[f,G],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block}.instrument-tile[_ngcontent-%COMP%]{background:var(--gb-bg-panel);border:1px solid var(--gb-border-panel);border-radius:14px;padding:var(--space-3, 12px);display:flex;flex-direction:column;align-items:center;gap:var(--space-2, 8px);position:relative;box-shadow:var(--gb-shadow-instrument, none);aspect-ratio:1;transition:border-color .2s ease}.instrument-tile[_ngcontent-%COMP%]:hover{border-color:var(--gb-accent, var(--gb-border-panel))}.instrument-tile--wide[_ngcontent-%COMP%]{aspect-ratio:2/1;grid-column:span 2}.instrument-tile--compact[_ngcontent-%COMP%]{padding:var(--space-2, 8px);gap:var(--space-1, 4px)}.instrument-tile--stale[_ngcontent-%COMP%]{border-color:rgba(var(--gb-data-stale-rgb, 243, 177, 63),.3)}.instrument-tile--stale[_ngcontent-%COMP%]   .instrument-tile__value[_ngcontent-%COMP%]{color:var(--gb-text-stale, var(--gb-text-muted))}.instrument-tile__label[_ngcontent-%COMP%]{font-family:Space Grotesk,sans-serif;font-size:.55rem;font-weight:700;text-transform:uppercase;letter-spacing:.15em;color:var(--gb-text-muted);align-self:flex-start;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%}.instrument-tile__gauge[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;width:100%}.instrument-tile__value-group[_ngcontent-%COMP%]{display:flex;align-items:baseline;gap:4px;align-self:flex-end}.instrument-tile__value[_ngcontent-%COMP%]{font-family:JetBrains Mono,monospace;font-variant-numeric:tabular-nums;font-size:1.5rem;font-weight:400;color:var(--gb-text-value);line-height:1}.instrument-tile__unit[_ngcontent-%COMP%]{font-family:Space Grotesk,sans-serif;font-size:.6rem;font-weight:600;text-transform:uppercase;letter-spacing:.1em;color:var(--gb-text-unit)}.instrument-tile__bar-track[_ngcontent-%COMP%]{height:4px;background:var(--gb-bg-bezel, rgba(255, 255, 255, .06));border-radius:2px;overflow:hidden;width:100%}.instrument-tile__bar-fill[_ngcontent-%COMP%]{height:100%;border-radius:2px;transition:width .3s ease;background:var(--gb-accent, #4a90d9)}.instrument-tile__bar-fill[data-level=warn][_ngcontent-%COMP%]{background:var(--gb-data-warn, #f3b13f)}.instrument-tile__bar-fill[data-level=danger][_ngcontent-%COMP%]{background:var(--gb-data-danger, #f06352)}[data-quality=stale][_ngcontent-%COMP%]   .instrument-tile__value[_ngcontent-%COMP%]{opacity:.5}[data-quality=missing][_ngcontent-%COMP%]   .instrument-tile__value[_ngcontent-%COMP%]{opacity:.3}.instrument-tile--compact[_ngcontent-%COMP%]   .instrument-tile__value[_ngcontent-%COMP%]{font-size:1rem}.instrument-tile--compact[_ngcontent-%COMP%]   .instrument-tile__label[_ngcontent-%COMP%]{font-size:.5rem}'],changeDetection:0})};var q=[{id:"navigation",label:"Navigation",icon:"compass"},{id:"wind",label:"Wind",icon:"wind"},{id:"depth",label:"Depth",icon:"anchor"},{id:"environment",label:"Environment",icon:"thermometer"},{id:"electrical",label:"Electrical",icon:"battery"},{id:"engine",label:"Engine",icon:"engine"},{id:"performance",label:"Performance",icon:"gauge"}],w=[{id:"sog",label:"Speed Over Ground",unit:"kts",path:e.navigation.speedOverGround,category:"navigation",displayType:"digital",minValue:0,maxValue:30,decimals:1},{id:"cog",label:"Course Over Ground",unit:"\xB0",path:e.navigation.courseOverGroundTrue,category:"navigation",displayType:"analog-circular",minValue:0,maxValue:360,decimals:0},{id:"hdg_true",label:"Heading True",unit:"\xB0T",path:e.navigation.headingTrue,category:"navigation",displayType:"analog-circular",minValue:0,maxValue:360,decimals:0},{id:"hdg_mag",label:"Heading Magnetic",unit:"\xB0M",path:e.navigation.headingMagnetic,category:"navigation",displayType:"analog-circular",minValue:0,maxValue:360,decimals:0},{id:"sow",label:"Speed Over Water",unit:"kts",path:e.navigation.speedThroughWater,category:"navigation",displayType:"digital",minValue:0,maxValue:30,decimals:1},{id:"vmg",label:"Velocity Made Good",unit:"kts",path:e.performance?.velocityMadeGood??"performance.velocityMadeGood",category:"navigation",displayType:"digital",decimals:1},{id:"cmg",label:"Course Made Good",unit:"\xB0",path:null,category:"navigation",displayType:"digital",decimals:0},{id:"xte",label:"Cross Track Error",unit:"NM",path:null,category:"navigation",displayType:"digital",decimals:2},{id:"dtw",label:"Distance to Waypoint",unit:"NM",path:null,category:"navigation",displayType:"digital",decimals:1},{id:"btw",label:"Bearing to Waypoint",unit:"\xB0",path:null,category:"navigation",displayType:"analog-circular",decimals:0},{id:"aws",label:"Apparent Wind Speed",unit:"kts",path:e.environment.wind.speedApparent,category:"wind",displayType:"digital",minValue:0,maxValue:60,decimals:1},{id:"awa",label:"Apparent Wind Angle",unit:"\xB0",path:e.environment.wind.angleApparent,category:"wind",displayType:"wind-rose",minValue:-180,maxValue:180,decimals:0},{id:"tws",label:"True Wind Speed",unit:"kts",path:e.environment.wind.speedTrue,category:"wind",displayType:"digital",minValue:0,maxValue:60,decimals:1},{id:"twa",label:"True Wind Angle",unit:"\xB0",path:e.environment.wind.angleTrueWater,category:"wind",displayType:"wind-rose",minValue:-180,maxValue:180,decimals:0},{id:"twd",label:"True Wind Direction",unit:"\xB0",path:e.environment.wind.directionTrue,category:"wind",displayType:"analog-circular",minValue:0,maxValue:360,decimals:0},{id:"gust",label:"Wind Gust",unit:"kts",path:null,category:"wind",displayType:"digital",decimals:1},{id:"gws",label:"Ground Wind Speed",unit:"kts",path:null,category:"wind",displayType:"digital",decimals:1},{id:"gwd",label:"Ground Wind Direction",unit:"\xB0",path:null,category:"wind",displayType:"analog-circular",decimals:0},{id:"depth_keel",label:"Depth Under Keel",unit:"m",path:e.environment.depth.belowKeel,category:"depth",displayType:"digital",minValue:0,dangerLow:1,warnLow:3,decimals:1},{id:"depth_transducer",label:"Depth Transducer",unit:"m",path:e.environment.depth.belowTransducer,category:"depth",displayType:"digital",minValue:0,dangerLow:1,warnLow:3,decimals:1},{id:"depth_surface",label:"Depth Surface",unit:"m",path:e.environment.depth.belowSurface,category:"depth",displayType:"digital",minValue:0,decimals:1},{id:"depth_trend",label:"Depth Trend",unit:"m/min",path:null,category:"depth",displayType:"analog-linear",decimals:2},{id:"water_temp",label:"Water Temperature",unit:"\xB0C",path:e.environment.water.temperature,category:"environment",displayType:"digital",decimals:1},{id:"air_temp",label:"Air Temperature",unit:"\xB0C",path:e.environment.outside.temperature,category:"environment",displayType:"digital",decimals:1},{id:"pressure",label:"Atmospheric Pressure",unit:"hPa",path:e.environment.outside.pressure,category:"environment",displayType:"digital",minValue:950,maxValue:1050,decimals:1},{id:"pressure_trend",label:"Pressure Trend",unit:"hPa/h",path:null,category:"environment",displayType:"analog-linear",decimals:1},{id:"humidity",label:"Humidity",unit:"%",path:e.environment.outside.humidity,category:"environment",displayType:"digital",minValue:0,maxValue:100,decimals:0},{id:"dew_point",label:"Dew Point",unit:"\xB0C",path:null,category:"environment",displayType:"digital",decimals:1},{id:"battery_v",label:"Battery Voltage",unit:"V",path:e.electrical.batteries.house.voltage,category:"electrical",displayType:"digital",minValue:10,maxValue:15,dangerLow:11,warnLow:11.8,decimals:1},{id:"battery_a",label:"Battery Current",unit:"A",path:e.electrical.batteries.house.current,category:"electrical",displayType:"digital",decimals:1},{id:"battery_soc",label:"State of Charge",unit:"%",path:e.electrical.batteries.house.stateOfCharge,category:"electrical",displayType:"analog-linear",minValue:0,maxValue:100,dangerLow:20,warnLow:40,decimals:0},{id:"solar_v",label:"Solar Voltage",unit:"V",path:e.electrical.solar.voltage,category:"electrical",displayType:"digital",decimals:1},{id:"solar_a",label:"Solar Current",unit:"A",path:e.electrical.solar.current,category:"electrical",displayType:"digital",decimals:1},{id:"alternator",label:"Alternator",unit:"A",path:e.electrical.batteries.alternator.current,category:"electrical",displayType:"digital",decimals:1},{id:"consumption",label:"Consumption",unit:"A",path:null,category:"electrical",displayType:"digital",decimals:1},{id:"rpm",label:"Engine RPM",unit:"RPM",path:e.propulsion.main.revolutions,category:"engine",displayType:"analog-circular",minValue:0,maxValue:4e3,warnHigh:3200,dangerHigh:3600,decimals:0},{id:"coolant_temp",label:"Coolant Temp",unit:"\xB0C",path:e.propulsion.main.temperature,category:"engine",displayType:"digital",warnHigh:90,dangerHigh:100,decimals:0},{id:"oil_pressure",label:"Oil Pressure",unit:"bar",path:e.propulsion.main.oilPressure,category:"engine",displayType:"digital",dangerLow:1,warnLow:1.5,decimals:1},{id:"fuel_level",label:"Fuel Level",unit:"%",path:e.tanks.fuel.level,category:"engine",displayType:"analog-linear",minValue:0,maxValue:100,dangerLow:10,warnLow:25,decimals:0},{id:"fuel_flow",label:"Fuel Flow",unit:"l/h",path:e.propulsion.main.fuelRate,category:"engine",displayType:"digital",decimals:1},{id:"engine_hours",label:"Engine Hours",unit:"h",path:e.propulsion.main.runTime,category:"engine",displayType:"digital",decimals:0},{id:"transmission",label:"Transmission",unit:"",path:e.propulsion.main.transmission,category:"engine",displayType:"digital",decimals:0},{id:"polar_speed",label:"Polar Speed",unit:"kts",path:e.performance?.polarSpeed??"performance.polarSpeed",category:"performance",displayType:"digital",decimals:1},{id:"polar_ratio",label:"Polar Ratio",unit:"%",path:e.performance?.polarSpeedRatio??"performance.polarSpeedRatio",category:"performance",displayType:"analog-linear",minValue:0,maxValue:120,decimals:0},{id:"target_twa",label:"Target TWA",unit:"\xB0",path:e.performance?.targetTwa??"performance.targetAngle",category:"performance",displayType:"digital",decimals:0},{id:"layline_port",label:"Layline Port",unit:"\xB0",path:null,category:"performance",displayType:"digital",decimals:0},{id:"layline_stbd",label:"Layline Starboard",unit:"\xB0",path:null,category:"performance",displayType:"digital",decimals:0},{id:"heel",label:"Heel Angle",unit:"\xB0",path:e.navigation.attitude,category:"performance",displayType:"analog-linear",minValue:-45,maxValue:45,warnHigh:25,dangerHigh:35,decimals:0},{id:"pitch",label:"Pitch Angle",unit:"\xB0",path:e.navigation.attitude,category:"performance",displayType:"analog-linear",minValue:-30,maxValue:30,decimals:0},{id:"leeway_angle",label:"Leeway",unit:"\xB0",path:e.navigation.leeway,category:"performance",displayType:"digital",decimals:0}];function I(i){return w.filter(t=>t.category===i)}var z=(i,t)=>t.id;function Q(i,t){if(i&1){let a=D();o(0,"button",4),h("click",function(){let x=S(a).$implicit,C=u();return O(C.activeCategory.set(x.id))}),s(1),l()}if(i&2){let a=t.$implicit,n=u();m("active",n.activeCategory()===a.id),d("aria-selected",n.activeCategory()===a.id),r(),E("",a.label," (",n.getCategoryCount(a.id),")")}}function J(i,t){if(i&1&&b(0,"omi-instrument-widget",8),i&2){let a=t.$implicit;g("config",a)("compact",!1)}}var U=class i{aisStore=c(B);store=c(v);categories=q;allCount=w.length;activeCategory=T("all");filteredInstruments=V(()=>{let t=this.activeCategory();return t==="all"?w:I(t)});getCategoryCount(t){return I(t).length}targetsMap=this.aisStore.targets;position=H(this.store.observe(e.navigation.position),{initialValue:null});sortBy=T("range");sortedTargets=V(()=>{let t=Array.from(this.targetsMap().values());return this.sortBy(),this.position(),t});handleSortChange(t){this.sortBy.set(t)}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=y({type:i,selectors:[["app-instruments-page"]],decls:19,vars:9,consts:[[1,"instruments-page"],[1,"instruments-toolbar"],[1,"instruments-toolbar__title"],["role","tablist",1,"instruments-toolbar__tabs"],["role","tab",1,"instruments-toolbar__tab",3,"click"],["role","tab",1,"instruments-toolbar__tab",3,"active"],[1,"instruments-content"],[1,"instruments-grid"],[3,"config","compact"],[1,"instruments-section"],[1,"instruments-section__title"],[1,"ais-panel"],[3,"sortChange","targets","sortBy"]],template:function(a,n){a&1&&(o(0,"div",0)(1,"div",1)(2,"h1",2),s(3),N(4,"translate"),l(),o(5,"div",3)(6,"button",4),h("click",function(){return n.activeCategory.set("all")}),s(7),l(),M(8,Q,2,5,"button",5,z),l()(),o(10,"div",6)(11,"div",7),M(12,J,1,2,"omi-instrument-widget",8,z),l(),o(14,"div",9)(15,"div",10),s(16,"AIS Targets"),l(),o(17,"div",11)(18,"app-ais-target-list",12),h("sortChange",function(C){return n.handleSortChange(C)}),l()()()()()),a&2&&(r(3),p(W(4,7,"instruments.page.title")),r(3),m("active",n.activeCategory()==="all"),d("aria-selected",n.activeCategory()==="all"),r(),L("All (",n.allCount,")"),r(),P(n.categories),r(4),P(n.filteredInstruments()),r(6),g("targets",n.sortedTargets())("sortBy",n.sortBy()))},dependencies:[f,_,R,F],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block;height:100%;overflow:hidden}.instruments-page[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow:hidden;background:var(--gb-bg-canvas)}.instruments-toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;padding:var(--space-3, 12px) var(--space-5, 24px);border-bottom:1px solid var(--gb-border-panel);background:var(--gb-bg-bezel);flex-shrink:0;gap:var(--space-3, 12px)}.instruments-toolbar__title[_ngcontent-%COMP%]{font-family:Space Grotesk,sans-serif;font-size:1rem;font-weight:700;color:var(--gb-text-value);margin:0;white-space:nowrap}.instruments-toolbar__tabs[_ngcontent-%COMP%]{display:flex;gap:2px;overflow-x:auto;padding:3px;background:var(--gb-bg-panel);border:1px solid var(--gb-border-panel);border-radius:10px;-webkit-overflow-scrolling:touch;scrollbar-width:none}.instruments-toolbar__tabs[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.instruments-toolbar__tab[_ngcontent-%COMP%]{background:transparent;border:none;color:var(--gb-text-muted);padding:6px 12px;border-radius:7px;font-family:Space Grotesk,sans-serif;font-weight:600;font-size:.7rem;cursor:pointer;transition:all .15s ease;white-space:nowrap;min-height:32px}.instruments-toolbar__tab[_ngcontent-%COMP%]:hover{background:var(--gb-bg-glass-active, rgba(255, 255, 255, .04));color:var(--gb-text-value)}.instruments-toolbar__tab.active[_ngcontent-%COMP%]{background:#4a90d926;color:#4a90d9}.instruments-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;overflow-x:hidden}.instruments-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:var(--space-3, 12px);padding:var(--space-4, 16px) var(--space-5, 24px)}.instruments-section[_ngcontent-%COMP%]{margin-bottom:var(--space-5, 24px);padding:0 var(--space-5, 24px)}.instruments-section__title[_ngcontent-%COMP%]{font-family:Space Grotesk,sans-serif;font-size:.65rem;font-weight:700;text-transform:uppercase;letter-spacing:.2em;color:var(--gb-text-muted);padding:var(--space-3, 12px) 0 var(--space-2, 8px);border-bottom:1px solid var(--gb-border-panel);margin-bottom:var(--space-3, 12px)}.ais-panel[_ngcontent-%COMP%]{background:var(--gb-bg-panel);border-radius:14px;border:1px solid var(--gb-border-panel);padding:var(--space-4, 16px)}@media(max-width:640px){.instruments-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);padding:var(--space-3, 12px)}.instruments-toolbar[_ngcontent-%COMP%]{flex-wrap:wrap;padding:var(--space-2, 8px) var(--space-3, 12px)}.instruments-section[_ngcontent-%COMP%]{padding:0 var(--space-3, 12px)}}'],changeDetection:0})};export{U as InstrumentsPage};
