<omi-gb-bezel class="marine-card" label="DEPTH" [quality]="view().quality">
  <div class="depth-gauge-container">
    <div class="digital-readout">
      <span class="value gb-display-value gb-display-value--xl" [class.alarm]="view().isShallow">{{ view().depthValue }}</span>
      <span class="unit gb-display-unit" *ngIf="view().depthValue !== '---'">{{ view().depthUnit }}</span>
    </div>

    <div class="gauge-graphic">
      <svg viewBox="0 0 60 160" class="gauge-svg" role="img" [attr.aria-label]="view().ariaLabel">
        <defs>
          <linearGradient id="depthFillGrad" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" stop-color="var(--gb-needle-secondary)" stop-opacity="0.8" />
            <stop offset="100%" stop-color="color-mix(in srgb, var(--gb-needle-secondary) 70%, var(--gb-bg-bezel))" stop-opacity="0.9" />
          </linearGradient>

          <linearGradient id="depthAlarmGrad" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" stop-color="var(--gb-data-stale)" stop-opacity="0.9" />
            <stop offset="100%" stop-color="color-mix(in srgb, var(--gb-data-stale) 70%, var(--gb-bg-bezel))" stop-opacity="0.95" />
          </linearGradient>

          <filter id="glowDepth">
            <feGaussianBlur stdDeviation="2" result="blur" />
            <feComposite in="SourceGraphic" in2="blur" operator="over" />
          </filter>
        </defs>

        <rect
          x="15"
          y="10"
          width="30"
          height="140"
          rx="15"
          ry="15"
          fill="var(--gb-bg-bezel)"
          stroke="var(--gb-border-panel)"
          stroke-width="1"
        />

        <rect
          x="17"
          y="12"
          width="26"
          [attr.height]="view().barHeight"
          [attr.fill]="view().isShallow ? 'url(#depthAlarmGrad)' : 'url(#depthFillGrad)'"
          rx="13"
          ry="13"
          class="bar-fill gb-needle-wrapper"
          [class.gb-needle-wrapper--stale]="view().isStale"
          filter="url(#glowDepth)"
        />

        <g class="ticks">
          <line x1="8" y1="12" x2="15" y2="12" stroke="var(--gb-text-unit)" stroke-width="1" />
          <line x1="8" y1="150" x2="15" y2="150" stroke="var(--gb-text-unit)" stroke-width="1" />
        </g>
      </svg>
    </div>
  </div>

  <div class="meta-row">
    <span class="gb-instrument-label" *ngIf="view().source">{{ view().source }}</span>
    <span class="gb-display-unit" *ngIf="view().age !== null">{{ view().age | number:'1.1-1' }}s</span>
  </div>
</omi-gb-bezel>
