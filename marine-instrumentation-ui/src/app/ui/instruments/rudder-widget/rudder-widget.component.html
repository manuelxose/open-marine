<omi-gb-bezel class="marine-card" label="RUDDER" [quality]="view().quality">
  <div class="rudder-container">
    <div class="scale-view">
      <svg
        viewBox="0 0 200 120"
        preserveAspectRatio="xMidYMax"
        class="rudder-svg"
        role="img"
        [attr.aria-label]="view().ariaLabel"
      >
        <defs>
          <linearGradient id="arc-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="var(--gb-data-stale)" stop-opacity="0.8" />
            <stop offset="50%" stop-color="var(--gb-needle-secondary)" stop-opacity="0.25" />
            <stop offset="100%" stop-color="var(--gb-data-good)" stop-opacity="0.8" />
          </linearGradient>
          <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
            <feGaussianBlur stdDeviation="2" result="coloredBlur" />
            <feMerge>
              <feMergeNode in="coloredBlur" />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
        </defs>

        <path d="M 10 110 A 90 90 0 0 1 190 110" class="scale-track-bg" />
        <path d="M 10 110 A 90 90 0 0 1 190 110" class="scale-track" stroke="url(#arc-gradient)" />

        <g class="ticks">
          <line x1="100" y1="100" x2="100" y2="115" class="tick-mark center-tick" />
          <line x1="18.5" y1="65" x2="26" y2="70" class="tick-mark" />
          <text x="15" y="60" class="tick-label port-text">40</text>
          <line x1="181.5" y1="65" x2="174" y2="70" class="tick-mark" />
          <text x="185" y="60" class="tick-label stbd-text">40</text>
        </g>

        <g
          class="gb-needle-wrapper indicator-group"
          [class.gb-needle-wrapper--stale]="view().isStale"
          [attr.transform]="getRotationTransform(view().angleDegrees)"
        >
          <path d="M 100 25 L 95 45 L 105 45 Z" class="needle-head" filter="url(#glow)" />
          <line x1="100" y1="45" x2="100" y2="105" class="needle-shaft" />
          <circle cx="100" cy="110" r="4" class="needle-pivot" />
        </g>
      </svg>
    </div>

    <div class="readout-panel">
      <div
        class="digital-value gb-display-value gb-display-value--lg"
        [ngClass]="{ 'port': view().side === 'PORT', 'stbd': view().side === 'STBD' }"
      >
        {{ view().angleDisplay }}<ng-container *ngIf="view().angleDisplay !== '---'">&#176;</ng-container>
      </div>

      <div class="readout-label">
        <span class="side-indicator gb-display-unit" [class.active-port]="view().side === 'PORT'" [class.active-stbd]="view().side === 'STBD'">
          {{ view().side === 'CENTER' ? 'MID' : view().side }}
        </span>
      </div>
    </div>

    <div class="meta-row">
      <span class="gb-instrument-label" *ngIf="view().source">{{ view().source }}</span>
      <span class="gb-display-unit" *ngIf="view().age !== null">{{ view().age | number:'1.1-1' }}s</span>
    </div>
  </div>
</omi-gb-bezel>
