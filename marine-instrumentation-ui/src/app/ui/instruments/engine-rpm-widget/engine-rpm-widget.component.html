<omi-gb-bezel class="marine-card" label="ENGINE" [quality]="view().quality">
  <div class="rpm-container">
    <svg viewBox="0 0 200 200" class="gauge-svg" role="img" [attr.aria-label]="view().ariaLabel">
      <defs>
        <linearGradient id="rpm-grad" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" stop-color="var(--gb-needle-secondary)" />
          <stop offset="70%" stop-color="var(--gb-data-good)" />
          <stop offset="100%" stop-color="var(--gb-data-stale)" />
        </linearGradient>
        <filter id="rpm-glow">
          <feGaussianBlur stdDeviation="2.5" result="coloredBlur" />
          <feMerge>
            <feMergeNode in="coloredBlur" />
            <feMergeNode in="SourceGraphic" />
          </feMerge>
        </filter>
      </defs>

      <path d="M 43.4 156.6 A 80 80 0 1 1 156.6 156.6" class="scale-track" transform="rotate(135, 100, 100)" />

      <circle cx="100" cy="100" r="82" fill="none" class="decor-ring" stroke-width="1" />

      <path
        d="M 43.4 156.6 A 80 80 0 1 1 156.6 156.6"
        class="scale-value"
        transform="rotate(135, 100, 100)"
        stroke="url(#rpm-grad)"
        stroke-dasharray="377"
        [attr.stroke-dashoffset]="getDashOffset(view().rpm)"
        filter="url(#rpm-glow)"
      />

      <g class="ticks">
        <text x="50" y="155">0</text>
        <text x="35" y="90">10</text>
        <text x="100" y="35">20</text>
        <text x="165" y="90">30</text>
        <text x="150" y="155" class="redline-text">40</text>
      </g>

      <g class="readout" transform="translate(100, 130)">
        <text class="value">{{ view().rpmDisplay }}</text>
        <text class="unit" y="15">RPM</text>
      </g>

      <g
        class="gb-needle-wrapper needle-group"
        [class.gb-needle-wrapper--stale]="view().isStale"
        [attr.transform]="getNeedleTransform(view().rpm)"
      >
        <path d="M 100 25 L 95 100 L 105 100 Z" class="needle" />
        <circle cx="100" cy="100" r="5" class="needle-center" />
      </g>
    </svg>

    <div class="meta-row">
      <span class="gb-instrument-label" *ngIf="view().source">{{ view().source }}</span>
      <span class="gb-display-unit" *ngIf="view().age !== null">{{ view().age | number:'1.1-1' }}s</span>
    </div>
  </div>
</omi-gb-bezel>
